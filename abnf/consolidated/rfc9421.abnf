
field-content = field-vchar [1*(SP / HTAB / field-vchar) field-vchar]
field-vchar = VCHAR / obs-text
obs-text = %x80-ff


parameters = *(";" *SP parameter)
sf-string = DQUOTE *chr DQUOTE
inner-list = "(" *SP [sf-item *(1*SP sf-item) *SP] ")" parameters
parameter = param-key ["=" param-value]
chr = unescaped / escaped
sf-item = bare-item parameters
param-key = key
param-value = bare-item
unescaped = %x20-21 / %x23-5b / %x5d-7e
escaped = "\" (DQUOTE / "\")
bare-item = sf-integer / sf-decimal / sf-string / sf-token / sf-binary / sf-boolean
key = (lcalpha / "*") *(lcalpha / DIGIT / "_" / "-" / "." / "*")
sf-integer = ["-"] 1*15DIGIT
sf-decimal = ["-"] 1*12DIGIT "." 1*3DIGIT
sf-token = (ALPHA / "*") *(tchar / ":" / "/")
sf-binary = ":" *(base64) ":"
sf-boolean = "?" boolean
lcalpha = %x61-7a
tchar = "!" / "#" / "$" / "%" / "&" / "'" / "*" / "+" / "-" / "." / "^" / "_" / "`" / "|" / "~" / DIGIT / ALPHA
base64 = ALPHA / DIGIT / "+" / "/" / "="
boolean = "0" / "1"
; Extracted from IETF RFC 9421
; Copyright (c) IETF Trust and the persons identified as authors of the code. All rights reserved.
; Redistribution and use in source and binary forms, with or without modification, is permitted pursuant to, and subject to the license terms contained in, the Revised BSD License set forth in Section 4.c of the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info).

signature-base = *( signature-base-line LF ) signature-params-line
signature-base-line = component-identifier ":" SP
    ( derived-component-value / *field-content )
    ; no obs-fold nor obs-text
component-identifier = component-name parameters
component-name = sf-string
derived-component-value = *( VCHAR / SP )
signature-params-line = DQUOTE "@signature-params" DQUOTE
     ":" SP inner-list